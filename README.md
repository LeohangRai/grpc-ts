## Required packages

- [grpc-tools](https://www.npmjs.com/package/grpc-tools)
- [grpc_tools_node_protoc_ts](https://www.npmjs.com/package/grpc_tools_node_protoc_ts)
- [google-protobuf](https://www.npmjs.com/package/google-protobuf) (the protobuf runtime library.)
- [@grpc/grpc-js](https://www.npmjs.com/package/@grpc/grpc-js) (pure JavaScript gRPC client, replacement for the [grpc](https://www.npmjs.com/package/grpc) (deprecated) library)

### grpc-tools

The `grpc-tools` module allows us to actually generate the static code that we need. Installing this module globally (not recommended anymore) makes the `grpc_tools_node_protoc_plugin` available for us, which we will use to generate JS output from our proto files.

This library also exports the `grpc_tools_node_protoc` executable, which accepts all of the same arguments as `protoc` itself. For use with Node.js, you most likely want to use the CommonJS-style imports. We will be using the local executable instead of globally installing this library.

NOTE: The executables installed by node libraries get installed inside of the `node_modules/.bin` directory.

The `grpc_tools_node_protoc` executable automatically includes the Node gRPC plugin, so it also accepts the --grpc_out=[option:]path argument.

We will add a script in our package.json file (or better yet a `Makefile`) to make use of the `grpc_tools_node_protoc` executable to generate JS code for us.

```sh
$ grpc_tools_node_protoc \
 --js_out=import_style=commonjs,binary:./src/pb \
 --grpc_out=grpc_js:./src/pb \
 -I proto proto/\*.proto
```

### grpc_tools_node_protoc_ts

This library can be used to generate corresponding TypeScript type definition files according to JS codes generated by `grpc_tools_node_protoc`.
We will add another script to make use of this library to generate TypeScript type definition files for us.

```sh
$ grpc_tools_node_protoc \
 --plugin=protoc-gen-ts=node_modules/.bin/protoc-gen-ts \
 --ts_out=grpc_js:./src/pb \
 -I proto proto/\*.proto
```

### Makefile

```sh
PROTOC=node_modules/.bin/grpc_tools_node_protoc
PROTOC_GEN_TS=node_modules/.bin/protoc-gen-ts

gen:
    $(PROTOC) \
    --js_out=import_style=commonjs,binary:./src/pb \
    --grpc_out=grpc_js:./src/pb \
    -I proto proto/\*.proto

    ${PROTOC} \
    --plugin=protoc-gen-ts=${PROTOC_GEN_TS} \
    --ts_out=grpc_js:./src/pb \
    -I proto proto/*.proto
```
